{% extends 'base.html' %}
{% load static %}
{% load markdown_extras %}
{% block title %}{{quiz_id.quiz_name}}{% endblock title %}

{% block body %}

<main class="container py-5">
    <div class="row">
        <div class="col-lg-8" data-bs-theme="dark" >
            <div id="app" class="m-2">
                <h2> quizes</h2>
                <hr> 
                
                <div v-for="question in questions"> 
                    <h3> [[question.question]]</h3>
                    <div class="form-check m-3" v-for="answer in question.answers">
                        <input @change="checkAnswer($event , question.id)" :value="answer.answer" class="form-check-input" type="radio" :name="question.question" id="flexRadioDefault1">
                        <label class="form-check-label" for="flexRadioDefault1">
                            [[answer.answer]]
                        </label>
                    </div>
                    <hr>        
                </div>

                <div>
                    <button class="btn btn-outline-success p-2 m-3" onClick="app.showscore();">Show Score</button>
                    <button class="btn btn-outline-warning p-2 m-3" onClick="window.location.reload();">Refresh</button>
                    <!-- Button trigger modal -->
                    <button type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#exampleModal">
                        Launch demo modal
                    </button>                    
                    <!-- Modal -->
                    <div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
                        <div class="modal-dialog">
                        <div class="modal-content">
                            <div class="modal-header">
                            <h1 class="modal-title fs-5" id="exampleModalLabel">Modal title</h1>
                            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                            </div>
                            <div class="modal-body">
                                [[score]]
                            </div>
                            <div class="modal-footer">
                            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                            <button type="button" class="btn btn-primary">Save changes</button>
                            </div>
                        </div>
                        </div>
                    </div>
                </div>
            </div>
        </div> 

        <!--START SideBAR-->
        <div class="col-lg-4" data-bs-theme="dark">
            <!-- Categories widget-->
            <div class="mb-4 card  bg-body-tertiary">
                <div class="row">
                    
                </div>
            </div>
            <!--end Categories widget-->
        
            <!-- Side widget-->
            <div class="card bg-body-tertiary mb-4 ">
                <div class="card-header">перевод</div>
                <div class="card-body ">
                    <table class="table table-dark">
                        <thead>
                            <tr>
                                <th scope="col">#</th>
                                <th scope="col">Арабский</th>
                                <th scope="col">руский</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for word in words %}
                            <tr>
                                <th scope="row">{{word.id}}</th>
                                <td>{{word.word_AR}}</td> 
                                <td>{{word.word_RU}}</td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div> 
        </div>
        <!-- END SideBAR-->
    </div>
</main>

    <script src="https://cdn.jsdelivr.net/npm/vue@2.7.8/dist/vue.js"></script>
    <script>
        var score = 0;
        var app = new Vue({
            el : '#app',
            delimiters: ['[[',']]'],
            data(){
                return{
                    quiz_id : '{{quiz_id.id}}',
                    questions : [],
                }
            }, 
            methods : {
                getQuestions(){
                    fetch(`api/get-quiz/${this.quiz_id}`)
                    .then(response => response.json())
                    .then( result =>{
                        this.questions = result.data
                    })
                },
                checkAnswer(event , id){
                    this.questions.map(question =>{
                        answers = question.answers
                        for(var i=0; i < answers.length; i++){
                            if(answers[i].answer == event.target.value){
                                if(answers[i].is_correct){
                                    score++
                                }
                            }
                        }
                    })
                },
                showscore(){
                    alert("your score is " + score);
                },
            },
            created(){
                this.getQuestions()
            }
        });
    </script> 
{% endblock body %}




